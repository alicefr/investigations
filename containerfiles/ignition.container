ARG BASE
FROM $BASE AS builder

ARG COMMIT=main

RUN yum install -y \
	git \
	golang \
	libblkid-devel \
	&& yum clean all

RUN git clone https://github.com/coreos/ignition.git \
	&& cd ignition \
	&& git checkout ${COMMIT} \
	&& ./build

FROM scratch

COPY --from=builder /ignition/bin/amd64/ignition /usr/bin/ignition
